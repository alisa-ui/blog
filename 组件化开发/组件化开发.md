##### **1.背景**

为什么要组件化？

我们关注的是组件化能解决什么样的问题？



###### 1.代码复用

面向对象语言的技术点发展，大多解决的是代码可复用问题，不管是封装、继承、多态，都是解决代码重用的不同解决方案，而组件化也是为了这个目的，将一个业务、一个功能、甚至一段代码组件化，以达到复用的目的。

###### 2.功能解耦合

功能解耦也可以说是贯穿整个编程发展的任务，为了代码复用的精准，自然也就要求其组件化出去的代码能够解耦，不依赖其他的代码。

###### 3.源码管理 

伴随着app的发展，app越来越复杂，开发人员也自然的越来越多，一般的开发人员分为不同等级，水平自然参差不齐，那么对于源码的管理则尤为重要，但是随着人员的增多，git代码上传、merge将会是一个巨大的工作，就算是经验丰富的工程师也未免出错，耗时严重、错误频出将会是一个大团队所经常面对的问题。

 

##### **2.如何组件化**

针对上述问题，我们可以采取以下措施 

1.将可重用的代码提取

2.去耦合

3.每个功能模块单独管理

 

那么我们的组件如何划分呢

![continue](/Users/apple/Desktop/blog/组件化开发/continue.png)



**基础组件库：** 基础组件库放一些最基础的工具类，比如金额格式化、手机号/身份证/邮箱的有效校验，实质就是不会依赖业务，不会和业务牵扯的功能。

**功能组件库：** 分享的封装、图片的轮播、跑马灯功能、推送功能的二次封装，即开发一次，以后都能快速集成的功能。

**业务组件库：** 登录组件、实名组件、消息组件、刷卡等。

**中间件（组件通讯）：** 各个业务组件拆分出来后，组件之间的通讯、传参、回调就要考虑了，此时就需要一个组件通讯的工具类来处理。



**项目工程就是一个壳，在组件库中寻找这个工程所需要的组件，然后拿过来组装成一个App**。



##### **3.组件之间如何通信**

   在将业务控制器拆分出去后，如果一个组件要调用另一个组件里面的控制器，平常的做法是直接 #import "控制器头文件"，现在在不同的组件里面是无法import的，那该怎么做呢？使用消息发送机制

思路：

1. 每个业务组件库里面会有一个控制器的配置文件（路由配置文件），标记着每个控制器的key；
2. 在App每次启动时，组件通讯的工具类里面需要解析控制器配置文件（路由配置文件），将其加载进内存；
3. 在内存中查询路由配置，找到具体的控制器并动态生成类，然后使用 “消息发送机制”进行调用函数、传参数、回调，都能做到。

**好处：**

1.解除了控制器之间的依赖

 2.使用iOS的消息发送机制进行传参数、回调参数、透传参数

 3.路由表配置文件，能实现界面动态配置、动态生成界面

 4.路由表配置文件放到服务端，还可以实现线上App的跳转逻辑

 5.将控制器的key提供给H5，还可以实现H5跳转到Native界面



**总结**

组件化意味着重构，目的是让每个组件职责单一以提升集成效率。包管理技术Pod是组件化常用的工具，iOS组件依赖及组件版本号确定，都可以用pod实现。